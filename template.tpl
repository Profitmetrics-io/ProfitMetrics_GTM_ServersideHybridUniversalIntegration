___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "pmsshui",
  "version": 1,
  "securityGroups": [],
  "displayName": "PM Serverside Hybrid Universal Integration Script",
  "categories": [
    "ADVERTISING",
    "ANALYTICS",
    "ATTRIBUTION",
    "CONVERSIONS",
    "MARKETING"
  ],
  "brand": {
    "id": "github.com_Profitmetrics-io",
    "displayName": "Profitmetrics.io",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "IMPORTANT:\nThe tag must trigger on \"All pages\" after consent update. \nThe tag supports Google Consent Mode by default.\nNo additional consent is needed to fire this tag.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "publicId",
    "displayName": "Public ID",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "You can find your Public ID in ProfitMetrics.io under \"Websites\"",
    "valueHint": "1A2B3C4D5E6F7G8H",
    "valueValidators": [
      {
        "type": "STRING_LENGTH",
        "args": [
          16,
          16
        ]
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "className",
    "displayName": "Email input CSS selector",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Insert the CSS selector of the email input field. If you don\u0027t know this we recommend using the \"SelectorGadget\" chrome extension available here: https://chrome.google.com/webstore/detail/selectorgadget",
    "valueHint": ".class-name"
  },
  {
    "type": "TEXT",
    "name": "email",
    "displayName": "Customer Email",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Insert a variable that contains the user email",
    "valueHint": "mail@example.com",
    "enablingConditions": [
      {
        "paramName": "useHashedEmail",
        "paramValue": false,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "emailSHA256",
    "displayName": "Customer Email SHA256",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Insert a variable that contains the user email",
    "valueHint": "Required",
    "enablingConditions": [
      {
        "paramName": "useHashedEmail",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "notSetText": "Required"
  },
  {
    "type": "TEXT",
    "name": "emailMD5",
    "displayName": "Customer Email MD5",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Insert a variable that contains the user email",
    "valueHint": "Required",
    "enablingConditions": [
      {
        "paramName": "useHashedEmail",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "notSetText": "Required"
  },
  {
    "type": "SELECT",
    "name": "consentType",
    "displayName": "Consent control",
    "selectItems": [
      {
        "value": "googleConsentMode",
        "displayValue": "Google Consent Mode"
      },
      {
        "value": "auto",
        "displayValue": "Auto"
      },
      {
        "value": "custom",
        "displayValue": "Custom"
      },
      {
        "value": "ignore",
        "displayValue": "Ignore"
      }
    ],
    "simpleValueType": true,
    "subParams": [
      {
        "type": "TEXT",
        "name": "consentStatistics",
        "displayName": "Statistics consent",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "consentType",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ],
        "help": "Insert a custom variable with a boolean value (true/false)",
        "valueHint": "true/false"
      },
      {
        "type": "TEXT",
        "name": "consentMarketing",
        "displayName": "Marketing consent",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "consentType",
            "paramValue": "custom",
            "type": "EQUALS"
          }
        ],
        "help": "Insert a custom variable with a boolean value (true/false)",
        "valueHint": "true/false"
      }
    ],
    "alwaysInSummary": true
  },
  {
    "type": "CHECKBOX",
    "name": "klarnaCheckout",
    "checkboxText": "Use Klarna Checkout",
    "simpleValueType": true,
    "help": "Collect customer email from Klarna Checkout."
  },
  {
    "type": "TEXT",
    "name": "klarnaCheckoutPath",
    "displayName": "Klarna Checkout Path",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "klarnaCheckout",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "help": "The path of your checkout page. Usually something like /checkout.",
    "valueHint": "/checkout",
    "defaultValue": "/checkout"
  },
  {
    "type": "GROUP",
    "name": "settings",
    "displayName": "Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "TEXT",
        "name": "cookieDomain",
        "displayName": "Cookie domain",
        "simpleValueType": true,
        "alwaysInSummary": true,
        "help": "If your website has \"da.example.com\" and \"en.example.com\" you can use \".example.com\" to set the pmStorage cookie on the top-level domain.",
        "valueHint": ".example.com"
      },
      {
        "type": "CHECKBOX",
        "name": "useHashedEmail",
        "checkboxText": "Use hashed email",
        "simpleValueType": true,
        "help": "ProfitMetrics will automatically hash the customer email correctly on our end. If you enable \"Use hashed email\" it is required to provide both SHA256 and MD5 hashes to ensure full compatability.",
        "alwaysInSummary": true
      },
      {
        "type": "CHECKBOX",
        "name": "debugMode",
        "checkboxText": "Debug mode",
        "simpleValueType": true,
        "help": "Enable to write messages to the console.",
        "alwaysInSummary": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Required api
const log = require('logToConsole');
const injectScript = require('injectScript');
const isConsentGranted = require('isConsentGranted');
const setInWindow = require('setInWindow');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const callLater = require('callLater');

// Variables
var pmPublicID = data.publicId;
var pmCookieDomain = data.cookieDomain;
var pmEmailInputSelector = data.className;
var pmEmail = data.email;
var pmEmailMD5 = data.emailMD5;
var pmEmailSHA256 = data.emailSHA256;

// Settings
var klarnaCheckout = data.klarnaCheckout;
var klarnaCheckoutPath = data.klarnaCheckoutPath;
var useHashedEmail = data.useHashedEmail;



// Check pmEmailMD5 and set it to pmEmaiSHA256 if not set
if (useHashedEmail && !pmEmailMD5) {
    pmEmailMD5 = pmEmailSHA256;
}

// Check and truncate pmEmailMD5 if it's longer than 32 characters
if (useHashedEmail && pmEmailMD5 && pmEmailMD5.length > 32) {
    pmEmailMD5 = pmEmailMD5.substring(0, 32);
}


// Function to handle debug logs
function debugLog(message) {
  if (data.debugMode) {
    log(message);
  }
}


let adStorageConsent = isConsentGranted('ad_storage');
let analyticsStorageConsent = isConsentGranted('analytics_storage');

if (!pmPublicID) {
  debugLog('Error: Public ID is undefined.');
  data.gtmOnFailure();
  return;
}


// Initialize empty profitMetricsConfig object
const profitMetricsConfig = {};


// Now set the PID and other properties
profitMetricsConfig.pid = pmPublicID;

// Handle different consent modes
if (data.consentType === 'googleConsentMode' || data.consentType === undefined) {
  profitMetricsConfig.cookieStatisticsConsent = analyticsStorageConsent;
  profitMetricsConfig.cookieMarketingConsent = adStorageConsent;
} else if (data.consentType === 'auto') {
} else if (data.consentType === 'custom') {
  profitMetricsConfig.cookieStatisticsConsent = typeof data.consentStatistics !== 'undefined' && (data.consentStatistics === false || data.consentStatistics === "false") ? false : true;
  profitMetricsConfig.cookieMarketingConsent = typeof data.consentMarketing !== 'undefined' && (data.consentMarketing === false || data.consentMarketing === "false") ? false : true;
} else if (data.consentType === 'ignore') {
  profitMetricsConfig.cookieStatisticsConsent = true;
  profitMetricsConfig.cookieMarketingConsent = true;
}

// Set email input Selector
if(pmEmailInputSelector){
  profitMetricsConfig.emailInputSelector = pmEmailInputSelector;
}

// Set Cookiedomain 
if (pmCookieDomain) {
  profitMetricsConfig.cookieDomain = pmCookieDomain.indexOf('.') === 0 ? pmCookieDomain : '.' + pmCookieDomain;
}

// Set Klarna Checkout
if (klarnaCheckout && klarnaCheckoutPath){
  profitMetricsConfig.enableKlarnaTracking = true;
  profitMetricsConfig.checkoutPath = klarnaCheckoutPath;
}


// Include setEmail and setHashedEmail in onLoad function if email or hashed email exists
profitMetricsConfig.onLoad = function() {
  
  if (typeof pmEmail === 'string' && pmEmail.indexOf('@') > -1) {
    var setEmail = copyFromWindow('profitMetrics.setEmail');
    
    if (typeof setEmail === 'function') {
      setEmail(pmEmail);
      debugLog('onLoad function sucessfull');
    } else {
      debugLog('setEmail function not available');
    }
  }
  
  
  if (pmEmailSHA256 && pmEmailMD5) {
    var setHashedEmail = copyFromWindow('profitMetrics.setHashedEmail');
    
    if (typeof setHashedEmail === 'function') {
      setHashedEmail(pmEmailMD5, pmEmailSHA256);
      debugLog('onLoad function sucessfull');
    } else {
      debugLog('setEmail function not available');
    }
  }

};

// Log when window.profitMetrics is loaded
debugLog('window.profitMetrics is loaded.');
// Set window.profitMetrics
setInWindow('profitMetrics', profitMetricsConfig);

const scriptURL = 'https://cdn1.profitmetrics.io/' + pmPublicID + '/bundle.js';
injectScript(scriptURL, function() {
  debugLog('bundle.js is loaded.');
  data.gtmOnSuccess();
}, function() {
  debugLog('Error: Failed to load the ProfitMetrics script.');
  // Handle the error, for example by calling a failure callback.
  data.gtmOnFailure();
});


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn1.profitmetrics.io/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "profitMetrics"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "profitMetrics.setEmail"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "profitMetrics.onLoad"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "profitMetricsScriptLoaded"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "profitMetrics.setHashedEmail"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []
setup: ''


___NOTES___

Created on 11.8.2023 22.05.58


